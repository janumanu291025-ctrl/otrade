import { c as create_ssr_component, a as subscribe, o as onDestroy, e as escape } from "../../../../chunks/ssr.js";
import "../../../../chunks/api.js";
import { m as marketData, w as websocket } from "../../../../chunks/websocket.js";
const css = {
  code: ".positions-panel.svelte-1kjlua3.svelte-1kjlua3{background:white;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1);overflow:hidden}.panel-header.svelte-1kjlua3.svelte-1kjlua3{padding:1rem 1.5rem;background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:white;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}.panel-header.svelte-1kjlua3 h2.svelte-1kjlua3{margin:0;font-size:1.25rem}.header-info.svelte-1kjlua3.svelte-1kjlua3{display:flex;align-items:center;gap:1rem}.total-pnl.svelte-1kjlua3.svelte-1kjlua3{display:flex;align-items:center;gap:0.5rem;font-size:1rem}.pnl-label.svelte-1kjlua3.svelte-1kjlua3{font-weight:500;opacity:0.9}.pnl-value.svelte-1kjlua3.svelte-1kjlua3{font-weight:700;font-size:1.1rem}.pnl-value.positive.svelte-1kjlua3.svelte-1kjlua3{color:#10b981}.pnl-value.negative.svelte-1kjlua3.svelte-1kjlua3{color:#ef4444}.pnl-value.neutral.svelte-1kjlua3.svelte-1kjlua3{color:#6b7280}.header-actions.svelte-1kjlua3.svelte-1kjlua3{display:flex;gap:0.5rem;align-items:center}.btn-toggle.svelte-1kjlua3.svelte-1kjlua3{padding:0.5rem 1rem;border:none;border-radius:6px;cursor:pointer;font-size:0.875rem;font-weight:600;transition:all 0.2s;display:flex;align-items:center;gap:0.5rem}.btn-toggle.live.svelte-1kjlua3.svelte-1kjlua3{background:rgba(16, 185, 129, 0.2);color:#10b981}.btn-toggle.svelte-1kjlua3.svelte-1kjlua3:not(.live){background:rgba(255, 255, 255, 0.2);color:white}.toggle-indicator.svelte-1kjlua3.svelte-1kjlua3{color:#10b981;font-size:0.75rem;animation:svelte-1kjlua3-pulse 2s infinite}@keyframes svelte-1kjlua3-pulse{0%,100%{opacity:1}50%{opacity:0.5}}.btn-refresh.svelte-1kjlua3.svelte-1kjlua3{padding:0.5rem 1rem;background:rgba(255, 255, 255, 0.2);color:white;border:none;border-radius:6px;cursor:pointer;font-size:0.875rem;transition:background 0.2s}.btn-refresh.svelte-1kjlua3.svelte-1kjlua3:hover{background:rgba(255, 255, 255, 0.3)}.loading-state.svelte-1kjlua3.svelte-1kjlua3,.error-state.svelte-1kjlua3.svelte-1kjlua3,.empty-state.svelte-1kjlua3.svelte-1kjlua3{padding:3rem 1.5rem;text-align:center}.spinner.svelte-1kjlua3.svelte-1kjlua3{width:3rem;height:3rem;border:3px solid #f3f4f6;border-top:3px solid #667eea;border-radius:50%;animation:svelte-1kjlua3-spin 1s linear infinite;margin:0 auto 1rem}@keyframes svelte-1kjlua3-spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.error-icon.svelte-1kjlua3.svelte-1kjlua3{font-size:3rem;margin-bottom:1rem}.error-message.svelte-1kjlua3.svelte-1kjlua3{color:#ef4444;font-weight:600}.empty-icon.svelte-1kjlua3.svelte-1kjlua3{font-size:3rem;margin-bottom:1rem;opacity:0.5}.empty-title.svelte-1kjlua3.svelte-1kjlua3{font-size:1.25rem;font-weight:600;color:#374151;margin-bottom:0.5rem}.empty-subtitle.svelte-1kjlua3.svelte-1kjlua3{color:#6b7280}.table-container.svelte-1kjlua3.svelte-1kjlua3{overflow-x:auto;max-height:600px;overflow-y:auto}.positions-table.svelte-1kjlua3.svelte-1kjlua3{width:100%;border-collapse:collapse}thead.svelte-1kjlua3.svelte-1kjlua3{background:#f9fafb;position:sticky;top:0;z-index:10}th.svelte-1kjlua3.svelte-1kjlua3{padding:0.75rem 1rem;text-align:left;font-size:0.75rem;font-weight:700;color:#374151;text-transform:uppercase;border-bottom:2px solid #e5e7eb;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none}th.sortable.svelte-1kjlua3.svelte-1kjlua3:hover{background:#f3f4f6}.sort-icon.svelte-1kjlua3.svelte-1kjlua3{margin-left:0.25rem;font-size:0.75rem}td.svelte-1kjlua3.svelte-1kjlua3{padding:0.75rem 1rem;font-size:0.875rem;border-bottom:1px solid #f3f4f6}tbody.svelte-1kjlua3 tr.svelte-1kjlua3:hover{background:#f9fafb}tr.live-data.svelte-1kjlua3.svelte-1kjlua3{background:rgba(16, 185, 129, 0.05)}.instrument-cell.svelte-1kjlua3.svelte-1kjlua3{font-family:monospace;font-weight:600;display:flex;align-items:center;gap:0.5rem}.live-indicator.svelte-1kjlua3.svelte-1kjlua3{color:#10b981;font-size:0.75rem;animation:svelte-1kjlua3-pulse 2s infinite}.quantity-cell.svelte-1kjlua3.svelte-1kjlua3{font-weight:600;text-align:center}.quantity-cell.long.svelte-1kjlua3.svelte-1kjlua3{color:#10b981}.quantity-cell.short.svelte-1kjlua3.svelte-1kjlua3{color:#ef4444}.price-cell.svelte-1kjlua3.svelte-1kjlua3{font-family:monospace;font-weight:600;text-align:right}.pnl-cell.svelte-1kjlua3.svelte-1kjlua3,.change-cell.svelte-1kjlua3.svelte-1kjlua3{font-family:monospace;font-weight:700;text-align:right}.pnl-cell.positive.svelte-1kjlua3.svelte-1kjlua3,.change-cell.positive.svelte-1kjlua3.svelte-1kjlua3{color:#10b981}.pnl-cell.negative.svelte-1kjlua3.svelte-1kjlua3,.change-cell.negative.svelte-1kjlua3.svelte-1kjlua3{color:#ef4444}.pnl-cell.neutral.svelte-1kjlua3.svelte-1kjlua3,.change-cell.neutral.svelte-1kjlua3.svelte-1kjlua3{color:#6b7280}.table-footer.svelte-1kjlua3.svelte-1kjlua3{padding:1rem 1.5rem;background:#f9fafb;border-top:1px solid #e5e7eb}.results-count.svelte-1kjlua3.svelte-1kjlua3{margin:0;font-size:0.875rem;color:#6b7280}.count-highlight.svelte-1kjlua3.svelte-1kjlua3{font-weight:600;color:#374151}@media(max-width: 768px){.panel-header.svelte-1kjlua3.svelte-1kjlua3{flex-direction:column;align-items:stretch}.header-info.svelte-1kjlua3.svelte-1kjlua3,.header-actions.svelte-1kjlua3.svelte-1kjlua3{justify-content:center}th.svelte-1kjlua3.svelte-1kjlua3,td.svelte-1kjlua3.svelte-1kjlua3{padding:0.5rem}.total-pnl.svelte-1kjlua3.svelte-1kjlua3{justify-content:center}}",
  map: `{"version":3,"file":"+page.svelte","sources":["+page.svelte"],"sourcesContent":["<script>\\n\\timport { onMount, onDestroy } from 'svelte';\\n\\timport { brokerAPI } from '$lib/utils/api';\\n\\timport { websocket, marketData, formatPrice } from '$lib/stores/websocket';\\n\\n\\tlet positions = [];\\n\\tlet loading = true;\\n\\tlet error = null;\\n\\tlet totalPnl = 0;\\n\\tlet liveMode = true;  // Toggle for live updates\\n\\n\\t// Sorting state\\n\\tlet sortColumn = null;\\n\\tlet sortDirection = 'asc';\\n\\n\\tonMount(async () => {\\n\\t\\t// Connect to WebSocket\\n\\t\\tif (!$websocket.connected) {\\n\\t\\t\\twebsocket.connect();\\n\\t\\t}\\n\\n\\t\\tawait loadPositions();\\n\\n\\t\\t// Add global mouse event listeners for column resizing (browser only)\\n\\t\\tif (typeof document !== 'undefined') {\\n\\t\\t\\tdocument.addEventListener('mousemove', handleMouseMove);\\n\\t\\t\\tdocument.addEventListener('mouseup', handleMouseUp);\\n\\t\\t}\\n\\t});\\n\\n\\tonDestroy(() => {\\n\\t\\t// Unsubscribe from position market data\\n\\t\\tif (liveMode) {\\n\\t\\t\\twebsocket.unsubscribeMarketData('positions');\\n\\t\\t}\\n\\n\\t\\t// Check if we're in browser context\\n\\t\\tif (typeof document !== 'undefined') {\\n\\t\\t\\tdocument.removeEventListener('mousemove', handleMouseMove);\\n\\t\\t\\tdocument.removeEventListener('mouseup', handleMouseUp);\\n\\t\\t}\\n\\t});\\n\\n\\tasync function loadPositions() {\\n\\t\\tloading = true;\\n\\t\\terror = null;\\n\\t\\ttry {\\n\\t\\t\\tconst response = await brokerAPI.getPositions('kite');\\n\\t\\t\\t// Use 'net' positions (current actual positions)\\n\\t\\t\\tpositions = response.data?.net || [];\\n\\n\\t\\t\\t// Calculate total P&L\\n\\t\\t\\tcalculateTotalPnl();\\n\\n\\t\\t\\t// Subscribe to live market data for position instruments\\n\\t\\t\\tif (liveMode && positions.length > 0) {\\n\\t\\t\\t\\tconst instrumentTokens = positions\\n\\t\\t\\t\\t\\t.filter(pos => pos.quantity !== 0 && pos.instrument_token)\\n\\t\\t\\t\\t\\t.map(pos => pos.instrument_token);\\n\\n\\t\\t\\t\\tif (instrumentTokens.length > 0) {\\n\\t\\t\\t\\t\\twebsocket.subscribeMarketData('positions', instrumentTokens, 'quote');\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t} catch (err) {\\n\\t\\t\\tconsole.error('Error loading positions:', err);\\n\\t\\t\\terror = err.response?.data?.detail || err.message || 'Failed to load positions';\\n\\t\\t} finally {\\n\\t\\t\\tloading = false;\\n\\t\\t}\\n\\t}\\n\\n\\tfunction calculateTotalPnl() {\\n\\t\\ttotalPnl = positions.reduce((sum, pos) => {\\n\\t\\t\\tconst pnl = getLivePosition(pos).pnl || 0;\\n\\t\\t\\treturn sum + pnl;\\n\\t\\t}, 0);\\n\\t}\\n\\n\\t// Get position with live data if available\\n\\tfunction getLivePosition(position) {\\n\\t\\tif (!liveMode || !position.instrument_token) {\\n\\t\\t\\treturn position;\\n\\t\\t}\\n\\n\\t\\tconst liveTick = $marketData[position.instrument_token];\\n\\t\\tif (!liveTick) {\\n\\t\\t\\treturn position;\\n\\t\\t}\\n\\n\\t\\t// Update position with live data\\n\\t\\tconst livePrice = liveTick.last_price;  // Price is already in rupees from Kite\\n\\t\\tconst quantity = position.quantity || 0;\\n\\t\\tconst avgPrice = position.average_price || 0;\\n\\t\\tconst pnl = (livePrice - avgPrice) * quantity;\\n\\n\\t\\tconsole.log(\`[Position] \${position.tradingsymbol}: Live=‚Çπ\${livePrice.toFixed(2)}, Avg=‚Çπ\${avgPrice.toFixed(2)}, P&L=‚Çπ\${pnl.toFixed(2)}\`);\\n\\n\\t\\treturn {\\n\\t\\t\\t...position,\\n\\t\\t\\tlast_price: livePrice,\\n\\t\\t\\tpnl: pnl,\\n\\t\\t\\tvalue: livePrice * Math.abs(quantity),\\n\\t\\t\\t_isLive: true\\n\\t\\t};\\n\\t}\\n\\n\\t// Reactive statement to recalculate total P&L when market data or live mode changes\\n\\t$: if (liveMode && positions.length > 0 && $marketData) {\\n\\t\\ttotalPnl = positions.reduce((sum, pos) => {\\n\\t\\t\\tconst pnl = getLivePosition(pos).pnl || 0;\\n\\t\\t\\treturn sum + pnl;\\n\\t\\t}, 0);\\n\\t}\\n\\n\\tfunction calculateChangePercent(position) {\\n\\t\\tif (!position.average_price || position.average_price === 0) return 0;\\n\\t\\tconst change = position.last_price - position.average_price;\\n\\t\\treturn (change / position.average_price) * 100;\\n\\t}\\n\\n\\tfunction formatNumber(num, decimals = 2) {\\n\\t\\tif (num === null || num === undefined) return '-';\\n\\t\\treturn num.toFixed(decimals);\\n\\t}\\n\\n\\tfunction sortBy(column) {\\n\\t\\tif (sortColumn === column) {\\n\\t\\t\\tsortDirection = sortDirection === 'asc' ? 'desc' : 'asc';\\n\\t\\t} else {\\n\\t\\t\\tsortColumn = column;\\n\\t\\t\\tsortDirection = 'asc';\\n\\t\\t}\\n\\t}\\n\\n\\t// Reactive statement to sort positions (depends on positions, sortColumn, sortDirection, and marketData for live updates)\\n\\t$: sortedPositions = (() => {\\n\\t\\t// Force reactivity on marketData changes\\n\\t\\tconst _ = $marketData;\\n\\t\\tif (!sortColumn) return positions;\\n\\n\\t\\tconst sorted = [...positions].sort((a, b) => {\\n\\t\\t\\tlet aVal, bVal;\\n\\n\\t\\t\\tswitch (sortColumn) {\\n\\t\\t\\t\\tcase 'tradingsymbol':\\n\\t\\t\\t\\t\\taVal = a.tradingsymbol || '';\\n\\t\\t\\t\\t\\tbVal = b.tradingsymbol || '';\\n\\t\\t\\t\\t\\treturn sortDirection === 'asc'\\n\\t\\t\\t\\t\\t\\t? aVal.localeCompare(bVal)\\n\\t\\t\\t\\t\\t\\t: bVal.localeCompare(aVal);\\n\\t\\t\\t\\tcase 'quantity':\\n\\t\\t\\t\\t\\taVal = a.quantity || 0;\\n\\t\\t\\t\\t\\tbVal = b.quantity || 0;\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'average_price':\\n\\t\\t\\t\\t\\taVal = a.average_price || 0;\\n\\t\\t\\t\\t\\tbVal = b.average_price || 0;\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'last_price':\\n\\t\\t\\t\\t\\taVal = a.last_price || 0;\\n\\t\\t\\t\\t\\tbVal = b.last_price || 0;\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'pnl':\\n\\t\\t\\t\\t\\taVal = a.pnl || 0;\\n\\t\\t\\t\\t\\tbVal = b.pnl || 0;\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'change_percent':\\n\\t\\t\\t\\t\\taVal = calculateChangePercent(a);\\n\\t\\t\\t\\t\\tbVal = calculateChangePercent(b);\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tdefault:\\n\\t\\t\\t\\t\\treturn 0;\\n\\t\\t\\t}\\n\\n\\t\\t\\treturn sortDirection === 'asc' ? aVal - bVal : bVal - aVal;\\n\\t\\t});\\n\\n\\t\\treturn sorted;\\n\\t})();\\n\\n\\tfunction handleMouseMove(e) {\\n\\t\\t// Placeholder for column resizing (can be implemented later if needed)\\n\\t}\\n\\n\\tfunction handleMouseUp() {\\n\\t\\t// Placeholder for column resizing (can be implemented later if needed)\\n\\t}\\n<\/script>\\n\\n<svelte:head>\\n\\t<title>Positions - Live Trading</title>\\n</svelte:head>\\n\\n<div class=\\"positions-panel\\">\\n\\t<div class=\\"panel-header\\">\\n\\t\\t<h2>üíº Positions</h2>\\n\\t\\t<div class=\\"header-info\\">\\n\\t\\t\\t<div class=\\"total-pnl\\">\\n\\t\\t\\t\\t<span class=\\"pnl-label\\">Total P&L:</span>\\n\\t\\t\\t\\t<span class=\\"pnl-value {totalPnl > 0 ? 'positive' : totalPnl < 0 ? 'negative' : 'neutral'}\\">\\n\\t\\t\\t\\t\\t{totalPnl > 0 ? '+' : ''}{formatNumber(totalPnl)}\\n\\t\\t\\t\\t</span>\\n\\t\\t\\t</div>\\n\\t\\t</div>\\n\\t\\t<div class=\\"header-actions\\">\\n\\t\\t\\t<!-- Live Mode Toggle -->\\n\\t\\t\\t<button\\n\\t\\t\\t\\ton:click={() => { liveMode = !liveMode; if (!liveMode) websocket.unsubscribeMarketData('positions'); else loadPositions(); }}\\n\\t\\t\\t\\tclass=\\"btn-toggle {liveMode ? 'live' : 'static'}\\"\\n\\t\\t\\t>\\n\\t\\t\\t\\t{#if liveMode}\\n\\t\\t\\t\\t\\t<span class=\\"toggle-indicator\\">‚óè</span>\\n\\t\\t\\t\\t\\t<span>LIVE</span>\\n\\t\\t\\t\\t{:else}\\n\\t\\t\\t\\t\\t<span>Static</span>\\n\\t\\t\\t\\t{/if}\\n\\t\\t\\t</button>\\n\\n\\t\\t\\t<button\\n\\t\\t\\t\\ton:click={loadPositions}\\n\\t\\t\\t\\tclass=\\"btn-refresh\\"\\n\\t\\t\\t\\ttitle=\\"Refresh positions\\"\\n\\t\\t\\t>\\n\\t\\t\\t\\tüîÑ Refresh\\n\\t\\t\\t</button>\\n\\t\\t</div>\\n\\t</div>\\n\\n\\t<!-- Content -->\\n\\t{#if loading}\\n\\t\\t<div class=\\"loading-state\\">\\n\\t\\t\\t<div class=\\"spinner\\"></div>\\n\\t\\t\\t<p>Loading positions...</p>\\n\\t\\t</div>\\n\\t{:else if error}\\n\\t\\t<div class=\\"error-state\\">\\n\\t\\t\\t<div class=\\"error-icon\\">‚ö†Ô∏è</div>\\n\\t\\t\\t<p class=\\"error-message\\">{error}</p>\\n\\t\\t</div>\\n\\t{:else if positions.length === 0}\\n\\t\\t<div class=\\"empty-state\\">\\n\\t\\t\\t<div class=\\"empty-icon\\">üíº</div>\\n\\t\\t\\t<p class=\\"empty-title\\">No positions found</p>\\n\\t\\t\\t<p class=\\"empty-subtitle\\">You don't have any open positions</p>\\n\\t\\t</div>\\n\\t{:else}\\n\\t\\t<div class=\\"table-container\\">\\n\\t\\t\\t<table class=\\"positions-table\\">\\n\\t\\t\\t\\t<thead>\\n\\t\\t\\t\\t\\t<tr>\\n\\t\\t\\t\\t\\t\\t<th on:click={() => sortBy('tradingsymbol')} class=\\"sortable\\">\\n\\t\\t\\t\\t\\t\\t\\tInstrument\\n\\t\\t\\t\\t\\t\\t\\t{#if sortColumn === 'tradingsymbol'}\\n\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\"sort-icon\\">{sortDirection === 'asc' ? '‚Üë' : '‚Üì'}</span>\\n\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t\\t<th on:click={() => sortBy('quantity')} class=\\"sortable\\">\\n\\t\\t\\t\\t\\t\\t\\tQty\\n\\t\\t\\t\\t\\t\\t\\t{#if sortColumn === 'quantity'}\\n\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\"sort-icon\\">{sortDirection === 'asc' ? '‚Üë' : '‚Üì'}</span>\\n\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t\\t<th on:click={() => sortBy('average_price')} class=\\"sortable\\">\\n\\t\\t\\t\\t\\t\\t\\tAvg\\n\\t\\t\\t\\t\\t\\t\\t{#if sortColumn === 'average_price'}\\n\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\"sort-icon\\">{sortDirection === 'asc' ? '‚Üë' : '‚Üì'}</span>\\n\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t\\t<th on:click={() => sortBy('last_price')} class=\\"sortable\\">\\n\\t\\t\\t\\t\\t\\t\\tLTP\\n\\t\\t\\t\\t\\t\\t\\t{#if sortColumn === 'last_price'}\\n\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\"sort-icon\\">{sortDirection === 'asc' ? '‚Üë' : '‚Üì'}</span>\\n\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t\\t<th on:click={() => sortBy('pnl')} class=\\"sortable\\">\\n\\t\\t\\t\\t\\t\\t\\tP&L\\n\\t\\t\\t\\t\\t\\t\\t{#if sortColumn === 'pnl'}\\n\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\"sort-icon\\">{sortDirection === 'asc' ? '‚Üë' : '‚Üì'}</span>\\n\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t\\t<th on:click={() => sortBy('change_percent')} class=\\"sortable\\">\\n\\t\\t\\t\\t\\t\\t\\tChg%\\n\\t\\t\\t\\t\\t\\t\\t{#if sortColumn === 'change_percent'}\\n\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\"sort-icon\\">{sortDirection === 'asc' ? '‚Üë' : '‚Üì'}</span>\\n\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t</th>\\n\\t\\t\\t\\t\\t</tr>\\n\\t\\t\\t\\t</thead>\\n\\t\\t\\t\\t<tbody>\\n\\t\\t\\t\\t\\t{#each sortedPositions as position}\\n\\t\\t\\t\\t\\t\\t{@const livePos = getLivePosition(position)}\\n\\t\\t\\t\\t\\t\\t<tr class=\\"{livePos._isLive ? 'live-data' : ''}\\">\\n\\t\\t\\t\\t\\t\\t\\t<td class=\\"instrument-cell\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t{livePos.tradingsymbol}\\n\\t\\t\\t\\t\\t\\t\\t\\t{#if livePos._isLive}\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<span class=\\"live-indicator\\" title=\\"Live data\\">‚óè</span>\\n\\t\\t\\t\\t\\t\\t\\t\\t{/if}\\n\\t\\t\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\t\\t<td class=\\"quantity-cell {livePos.quantity > 0 ? 'long' : livePos.quantity < 0 ? 'short' : ''}\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t{livePos.quantity}\\n\\t\\t\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\t\\t<td class=\\"price-cell\\">{formatNumber(livePos.average_price)}</td>\\n\\t\\t\\t\\t\\t\\t\\t<td class=\\"price-cell\\">{formatNumber(livePos.last_price)}</td>\\n\\t\\t\\t\\t\\t\\t\\t<td class=\\"pnl-cell {livePos.pnl > 0 ? 'positive' : livePos.pnl < 0 ? 'negative' : 'neutral'}\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t{livePos.pnl > 0 ? '+' : ''}{formatNumber(livePos.pnl)}\\n\\t\\t\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\t\\t<td class=\\"change-cell {calculateChangePercent(livePos) > 0 ? 'positive' : calculateChangePercent(livePos) < 0 ? 'negative' : 'neutral'}\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t{calculateChangePercent(livePos) > 0 ? '+' : ''}{formatNumber(calculateChangePercent(livePos))}%\\n\\t\\t\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\t</tr>\\n\\t\\t\\t\\t\\t{/each}\\n\\t\\t\\t\\t</tbody>\\n\\t\\t\\t</table>\\n\\t\\t</div>\\n\\n\\t\\t<div class=\\"table-footer\\">\\n\\t\\t\\t<p class=\\"results-count\\">\\n\\t\\t\\t\\tShowing <span class=\\"count-highlight\\">{positions.length}</span>\\n\\t\\t\\t\\t{positions.length === 1 ? 'position' : 'positions'}\\n\\t\\t\\t</p>\\n\\t\\t</div>\\n\\t{/if}\\n</div>\\n\\n<style>\\n\\t.positions-panel {\\n\\t\\tbackground: white;\\n\\t\\tborder-radius: 8px;\\n\\t\\tbox-shadow: 0 2px 4px rgba(0,0,0,0.1);\\n\\t\\toverflow: hidden;\\n\\t}\\n\\n\\t.panel-header {\\n\\t\\tpadding: 1rem 1.5rem;\\n\\t\\tbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\\n\\t\\tcolor: white;\\n\\t\\tdisplay: flex;\\n\\t\\tjustify-content: space-between;\\n\\t\\talign-items: center;\\n\\t\\tflex-wrap: wrap;\\n\\t\\tgap: 1rem;\\n\\t}\\n\\n\\t.panel-header h2 {\\n\\t\\tmargin: 0;\\n\\t\\tfont-size: 1.25rem;\\n\\t}\\n\\n\\t.header-info {\\n\\t\\tdisplay: flex;\\n\\t\\talign-items: center;\\n\\t\\tgap: 1rem;\\n\\t}\\n\\n\\t.total-pnl {\\n\\t\\tdisplay: flex;\\n\\t\\talign-items: center;\\n\\t\\tgap: 0.5rem;\\n\\t\\tfont-size: 1rem;\\n\\t}\\n\\n\\t.pnl-label {\\n\\t\\tfont-weight: 500;\\n\\t\\topacity: 0.9;\\n\\t}\\n\\n\\t.pnl-value {\\n\\t\\tfont-weight: 700;\\n\\t\\tfont-size: 1.1rem;\\n\\t}\\n\\n\\t.pnl-value.positive {\\n\\t\\tcolor: #10b981;\\n\\t}\\n\\n\\t.pnl-value.negative {\\n\\t\\tcolor: #ef4444;\\n\\t}\\n\\n\\t.pnl-value.neutral {\\n\\t\\tcolor: #6b7280;\\n\\t}\\n\\n\\t.header-actions {\\n\\t\\tdisplay: flex;\\n\\t\\tgap: 0.5rem;\\n\\t\\talign-items: center;\\n\\t}\\n\\n\\t.btn-toggle {\\n\\t\\tpadding: 0.5rem 1rem;\\n\\t\\tborder: none;\\n\\t\\tborder-radius: 6px;\\n\\t\\tcursor: pointer;\\n\\t\\tfont-size: 0.875rem;\\n\\t\\tfont-weight: 600;\\n\\t\\ttransition: all 0.2s;\\n\\t\\tdisplay: flex;\\n\\t\\talign-items: center;\\n\\t\\tgap: 0.5rem;\\n\\t}\\n\\n\\t.btn-toggle.live {\\n\\t\\tbackground: rgba(16, 185, 129, 0.2);\\n\\t\\tcolor: #10b981;\\n\\t}\\n\\n\\t.btn-toggle:not(.live) {\\n\\t\\tbackground: rgba(255, 255, 255, 0.2);\\n\\t\\tcolor: white;\\n\\t}\\n\\n\\t.toggle-indicator {\\n\\t\\tcolor: #10b981;\\n\\t\\tfont-size: 0.75rem;\\n\\t\\tanimation: pulse 2s infinite;\\n\\t}\\n\\n\\t@keyframes pulse {\\n\\t\\t0%, 100% { opacity: 1; }\\n\\t\\t50% { opacity: 0.5; }\\n\\t}\\n\\n\\t.btn-refresh {\\n\\t\\tpadding: 0.5rem 1rem;\\n\\t\\tbackground: rgba(255, 255, 255, 0.2);\\n\\t\\tcolor: white;\\n\\t\\tborder: none;\\n\\t\\tborder-radius: 6px;\\n\\t\\tcursor: pointer;\\n\\t\\tfont-size: 0.875rem;\\n\\t\\ttransition: background 0.2s;\\n\\t}\\n\\n\\t.btn-refresh:hover {\\n\\t\\tbackground: rgba(255, 255, 255, 0.3);\\n\\t}\\n\\n\\t.loading-state,\\n\\t.error-state,\\n\\t.empty-state {\\n\\t\\tpadding: 3rem 1.5rem;\\n\\t\\ttext-align: center;\\n\\t}\\n\\n\\t.spinner {\\n\\t\\twidth: 3rem;\\n\\t\\theight: 3rem;\\n\\t\\tborder: 3px solid #f3f4f6;\\n\\t\\tborder-top: 3px solid #667eea;\\n\\t\\tborder-radius: 50%;\\n\\t\\tanimation: spin 1s linear infinite;\\n\\t\\tmargin: 0 auto 1rem;\\n\\t}\\n\\n\\t@keyframes spin {\\n\\t\\t0% { transform: rotate(0deg); }\\n\\t\\t100% { transform: rotate(360deg); }\\n\\t}\\n\\n\\t.error-icon {\\n\\t\\tfont-size: 3rem;\\n\\t\\tmargin-bottom: 1rem;\\n\\t}\\n\\n\\t.error-message {\\n\\t\\tcolor: #ef4444;\\n\\t\\tfont-weight: 600;\\n\\t}\\n\\n\\t.empty-icon {\\n\\t\\tfont-size: 3rem;\\n\\t\\tmargin-bottom: 1rem;\\n\\t\\topacity: 0.5;\\n\\t}\\n\\n\\t.empty-title {\\n\\t\\tfont-size: 1.25rem;\\n\\t\\tfont-weight: 600;\\n\\t\\tcolor: #374151;\\n\\t\\tmargin-bottom: 0.5rem;\\n\\t}\\n\\n\\t.empty-subtitle {\\n\\t\\tcolor: #6b7280;\\n\\t}\\n\\n\\t.table-container {\\n\\t\\toverflow-x: auto;\\n\\t\\tmax-height: 600px;\\n\\t\\toverflow-y: auto;\\n\\t}\\n\\n\\t.positions-table {\\n\\t\\twidth: 100%;\\n\\t\\tborder-collapse: collapse;\\n\\t}\\n\\n\\tthead {\\n\\t\\tbackground: #f9fafb;\\n\\t\\tposition: sticky;\\n\\t\\ttop: 0;\\n\\t\\tz-index: 10;\\n\\t}\\n\\n\\tth {\\n\\t\\tpadding: 0.75rem 1rem;\\n\\t\\ttext-align: left;\\n\\t\\tfont-size: 0.75rem;\\n\\t\\tfont-weight: 700;\\n\\t\\tcolor: #374151;\\n\\t\\ttext-transform: uppercase;\\n\\t\\tborder-bottom: 2px solid #e5e7eb;\\n\\t\\tcursor: pointer;\\n\\t\\t-webkit-user-select: none;\\n\\t\\t   -moz-user-select: none;\\n\\t\\t        user-select: none;\\n\\t}\\n\\n\\tth.sortable:hover {\\n\\t\\tbackground: #f3f4f6;\\n\\t}\\n\\n\\t.sort-icon {\\n\\t\\tmargin-left: 0.25rem;\\n\\t\\tfont-size: 0.75rem;\\n\\t}\\n\\n\\ttd {\\n\\t\\tpadding: 0.75rem 1rem;\\n\\t\\tfont-size: 0.875rem;\\n\\t\\tborder-bottom: 1px solid #f3f4f6;\\n\\t}\\n\\n\\ttbody tr:hover {\\n\\t\\tbackground: #f9fafb;\\n\\t}\\n\\n\\ttr.live-data {\\n\\t\\tbackground: rgba(16, 185, 129, 0.05);\\n\\t}\\n\\n\\t.instrument-cell {\\n\\t\\tfont-family: monospace;\\n\\t\\tfont-weight: 600;\\n\\t\\tdisplay: flex;\\n\\t\\talign-items: center;\\n\\t\\tgap: 0.5rem;\\n\\t}\\n\\n\\t.live-indicator {\\n\\t\\tcolor: #10b981;\\n\\t\\tfont-size: 0.75rem;\\n\\t\\tanimation: pulse 2s infinite;\\n\\t}\\n\\n\\t.quantity-cell {\\n\\t\\tfont-weight: 600;\\n\\t\\ttext-align: center;\\n\\t}\\n\\n\\t.quantity-cell.long {\\n\\t\\tcolor: #10b981;\\n\\t}\\n\\n\\t.quantity-cell.short {\\n\\t\\tcolor: #ef4444;\\n\\t}\\n\\n\\t.price-cell {\\n\\t\\tfont-family: monospace;\\n\\t\\tfont-weight: 600;\\n\\t\\ttext-align: right;\\n\\t}\\n\\n\\t.pnl-cell,\\n\\t.change-cell {\\n\\t\\tfont-family: monospace;\\n\\t\\tfont-weight: 700;\\n\\t\\ttext-align: right;\\n\\t}\\n\\n\\t.pnl-cell.positive,\\n\\t.change-cell.positive {\\n\\t\\tcolor: #10b981;\\n\\t}\\n\\n\\t.pnl-cell.negative,\\n\\t.change-cell.negative {\\n\\t\\tcolor: #ef4444;\\n\\t}\\n\\n\\t.pnl-cell.neutral,\\n\\t.change-cell.neutral {\\n\\t\\tcolor: #6b7280;\\n\\t}\\n\\n\\t.table-footer {\\n\\t\\tpadding: 1rem 1.5rem;\\n\\t\\tbackground: #f9fafb;\\n\\t\\tborder-top: 1px solid #e5e7eb;\\n\\t}\\n\\n\\t.results-count {\\n\\t\\tmargin: 0;\\n\\t\\tfont-size: 0.875rem;\\n\\t\\tcolor: #6b7280;\\n\\t}\\n\\n\\t.count-highlight {\\n\\t\\tfont-weight: 600;\\n\\t\\tcolor: #374151;\\n\\t}\\n\\n\\t@media (max-width: 768px) {\\n\\t\\t.panel-header {\\n\\t\\t\\tflex-direction: column;\\n\\t\\t\\talign-items: stretch;\\n\\t\\t}\\n\\n\\t\\t.header-info,\\n\\t\\t.header-actions {\\n\\t\\t\\tjustify-content: center;\\n\\t\\t}\\n\\n\\t\\tth,\\n\\t\\ttd {\\n\\t\\t\\tpadding: 0.5rem;\\n\\t\\t}\\n\\n\\t\\t.total-pnl {\\n\\t\\t\\tjustify-content: center;\\n\\t\\t}\\n\\t}\\n</style>\\n"],"names":[],"mappings":"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"}`
};
function formatNumber(num, decimals = 2) {
  if (num === null || num === void 0) return "-";
  return num.toFixed(decimals);
}
function handleMouseMove(e) {
}
function handleMouseUp() {
}
const Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {
  let $marketData, $$unsubscribe_marketData;
  let $$unsubscribe_websocket;
  $$unsubscribe_marketData = subscribe(marketData, (value) => $marketData = value);
  $$unsubscribe_websocket = subscribe(websocket, (value) => value);
  let positions = [];
  let totalPnl = 0;
  onDestroy(() => {
    {
      websocket.unsubscribeMarketData("positions");
    }
    if (typeof document !== "undefined") {
      document.removeEventListener("mousemove", handleMouseMove);
      document.removeEventListener("mouseup", handleMouseUp);
    }
  });
  function getLivePosition(position) {
    if (!position.instrument_token) {
      return position;
    }
    const liveTick = $marketData[position.instrument_token];
    if (!liveTick) {
      return position;
    }
    const livePrice = liveTick.last_price;
    const quantity = position.quantity || 0;
    const avgPrice = position.average_price || 0;
    const pnl = (livePrice - avgPrice) * quantity;
    console.log(`[Position] ${position.tradingsymbol}: Live=‚Çπ${livePrice.toFixed(2)}, Avg=‚Çπ${avgPrice.toFixed(2)}, P&L=‚Çπ${pnl.toFixed(2)}`);
    return {
      ...position,
      last_price: livePrice,
      pnl,
      value: livePrice * Math.abs(quantity),
      _isLive: true
    };
  }
  $$result.css.add(css);
  {
    if (positions.length > 0 && $marketData) {
      totalPnl = positions.reduce(
        (sum, pos) => {
          const pnl = getLivePosition(pos).pnl || 0;
          return sum + pnl;
        },
        0
      );
    }
  }
  $$unsubscribe_marketData();
  $$unsubscribe_websocket();
  return `${$$result.head += `<!-- HEAD_svelte-pmkqau_START -->${$$result.title = `<title>Positions - Live Trading</title>`, ""}<!-- HEAD_svelte-pmkqau_END -->`, ""} <div class="positions-panel svelte-1kjlua3"><div class="panel-header svelte-1kjlua3"><h2 class="svelte-1kjlua3" data-svelte-h="svelte-1w9fy3r">üíº Positions</h2> <div class="header-info svelte-1kjlua3"><div class="total-pnl svelte-1kjlua3"><span class="pnl-label svelte-1kjlua3" data-svelte-h="svelte-18du2iy">Total P&amp;L:</span> <span class="${"pnl-value " + escape(
    totalPnl > 0 ? "positive" : totalPnl < 0 ? "negative" : "neutral",
    true
  ) + " svelte-1kjlua3"}">${escape(totalPnl > 0 ? "+" : "")}${escape(formatNumber(totalPnl))}</span></div></div> <div class="header-actions svelte-1kjlua3"> <button class="${"btn-toggle " + escape("live", true) + " svelte-1kjlua3"}">${`<span class="toggle-indicator svelte-1kjlua3" data-svelte-h="svelte-1cqsomk">‚óè</span> <span data-svelte-h="svelte-11yucnc">LIVE</span>`}</button> <button class="btn-refresh svelte-1kjlua3" title="Refresh positions" data-svelte-h="svelte-12gj44x">üîÑ Refresh</button></div></div>  ${`<div class="loading-state svelte-1kjlua3" data-svelte-h="svelte-141z98f"><div class="spinner svelte-1kjlua3"></div> <p>Loading positions...</p></div>`} </div>`;
});
export {
  Page as default
};
