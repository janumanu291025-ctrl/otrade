import{w as s}from"./CinR6i2W.js";import{b as t}from"./C7KyscHc.js";function l(){const{subscribe:n,set:c,update:a}=s({brokerType:"kite",configured:!1,connected:!1,tokenExpired:!1,profile:null,funds:null,loading:!1,error:null});return{subscribe:n,setBrokerType(r){a(e=>({...e,brokerType:r}))},async loadStatus(r){a(e=>({...e,loading:!0,error:null}));try{const e=await t.getStatus(r);a(o=>({...o,brokerType:r,configured:e.data.configured,connected:e.data.connected,tokenExpired:e.data.token_expired||!1,loading:!1}))}catch(e){a(o=>({...o,error:e.message,loading:!1}))}},async loadProfile(r){try{const e=await t.getProfile(r);a(o=>({...o,profile:e.data}))}catch(e){console.error("Failed to load profile:",e)}},async loadFunds(r){try{const e=await t.getFunds(r);a(o=>({...o,funds:e.data}))}catch(e){console.error("Failed to load funds:",e)}},async disconnect(r){try{await t.disconnect(r),a(e=>({...e,connected:!1,profile:null,funds:null}))}catch(e){a(o=>({...o,error:e.message}))}}}}const f=l();export{f as b};
