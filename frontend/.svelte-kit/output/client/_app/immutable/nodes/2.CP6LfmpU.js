import{s as B,E as K,d as E,I as y,F as Q,G as X,H as Y,i as Z,b as i,m as o,c as k,e as N,o as H,g as S,h as b,j as R,k as x,p as ee,C as te}from"../chunks/cb-04oXe.js";import{S as se,i as ae,a as ne,t as ie}from"../chunks/BeocxfxK.js";import{p as oe}from"../chunks/CksbSyzg.js";import{c as le,l as re,p as ce,s as ve,i as J,n as z}from"../chunks/DCKTeHYU.js";function de(r){let v,f,w,D='<h2 class="svelte-1yv13ag">ğŸ”´ Live Trading</h2> <p class="svelte-1yv13ag">Real-time automated trading system</p>',A,s,n,L='<span class="icon svelte-1yv13ag">ğŸ“Š</span> <span>Dashboard</span>',M,p,T='<span class="icon svelte-1yv13ag">ğŸ’¼</span> <span>Positions</span>',$,u,e='<span class="icon svelte-1yv13ag">ğŸ“‹</span> <span>Orders</span>',a,l,W='<span class="icon svelte-1yv13ag">ğŸ“ˆ</span> <span>Signals</span>',V,g,O='<span class="icon svelte-1yv13ag">ğŸ“‰</span> <span>Analytics</span>',I,m,q='<span class="icon svelte-1yv13ag">âš™ï¸</span> <span>Settings</span>',U,C,h;const F=r[3].default,d=K(F,r,r[2],null);return{c(){v=b("div"),f=b("div"),w=b("div"),w.innerHTML=D,A=R(),s=b("nav"),n=b("a"),n.innerHTML=L,M=R(),p=b("a"),p.innerHTML=T,$=R(),u=b("a"),u.innerHTML=e,a=R(),l=b("a"),l.innerHTML=W,V=R(),g=b("a"),g.innerHTML=O,I=R(),m=b("a"),m.innerHTML=q,U=R(),C=b("div"),d&&d.c(),this.h()},l(t){v=k(t,"DIV",{class:!0});var c=N(v);f=k(c,"DIV",{class:!0});var P=N(f);w=k(P,"DIV",{class:!0,"data-svelte-h":!0}),H(w)!=="svelte-1j1qbd5"&&(w.innerHTML=D),A=S(P),s=k(P,"NAV",{class:!0});var _=N(s);n=k(_,"A",{href:!0,class:!0,"data-svelte-h":!0}),H(n)!=="svelte-1qibeji"&&(n.innerHTML=L),M=S(_),p=k(_,"A",{href:!0,class:!0,"data-svelte-h":!0}),H(p)!=="svelte-1j92dxc"&&(p.innerHTML=T),$=S(_),u=k(_,"A",{href:!0,class:!0,"data-svelte-h":!0}),H(u)!=="svelte-142s6x0"&&(u.innerHTML=e),a=S(_),l=k(_,"A",{href:!0,class:!0,"data-svelte-h":!0}),H(l)!=="svelte-siqdov"&&(l.innerHTML=W),V=S(_),g=k(_,"A",{href:!0,class:!0,"data-svelte-h":!0}),H(g)!=="svelte-cf7i97"&&(g.innerHTML=O),I=S(_),m=k(_,"A",{href:!0,class:!0,"data-svelte-h":!0}),H(m)!=="svelte-1ea4gfc"&&(m.innerHTML=q),_.forEach(E),P.forEach(E),U=S(c),C=k(c,"DIV",{class:!0});var G=N(C);d&&d.l(G),G.forEach(E),c.forEach(E),this.h()},h(){o(w,"class","sub-nav-header svelte-1yv13ag"),o(n,"href","/live-trade"),o(n,"class","nav-link svelte-1yv13ag"),y(n,"active",r[0]==="/live-trade"),o(p,"href","/live-trade/positions"),o(p,"class","nav-link svelte-1yv13ag"),y(p,"active",r[0]==="/live-trade/positions"),o(u,"href","/live-trade/orders"),o(u,"class","nav-link svelte-1yv13ag"),y(u,"active",r[0]==="/live-trade/orders"),o(l,"href","/live-trade/signals"),o(l,"class","nav-link svelte-1yv13ag"),y(l,"active",r[0]==="/live-trade/signals"),o(g,"href","/live-trade/analytics"),o(g,"class","nav-link svelte-1yv13ag"),y(g,"active",r[0]==="/live-trade/analytics"),o(m,"href","/live-trade/settings"),o(m,"class","nav-link svelte-1yv13ag"),y(m,"active",r[0]==="/live-trade/settings"),o(s,"class","sub-nav-links svelte-1yv13ag"),o(f,"class","sub-nav svelte-1yv13ag"),o(C,"class","page-content svelte-1yv13ag"),o(v,"class","live-trade-layout svelte-1yv13ag")},m(t,c){Z(t,v,c),i(v,f),i(f,w),i(f,A),i(f,s),i(s,n),i(s,M),i(s,p),i(s,$),i(s,u),i(s,a),i(s,l),i(s,V),i(s,g),i(s,I),i(s,m),i(v,U),i(v,C),d&&d.m(C,null),h=!0},p(t,[c]){(!h||c&1)&&y(n,"active",t[0]==="/live-trade"),(!h||c&1)&&y(p,"active",t[0]==="/live-trade/positions"),(!h||c&1)&&y(u,"active",t[0]==="/live-trade/orders"),(!h||c&1)&&y(l,"active",t[0]==="/live-trade/signals"),(!h||c&1)&&y(g,"active",t[0]==="/live-trade/analytics"),(!h||c&1)&&y(m,"active",t[0]==="/live-trade/settings"),d&&d.p&&(!h||c&4)&&Q(d,F,t,t[2],h?Y(F,t[2],c,null):X(t[2]),null)},i(t){h||(ie(d,t),h=!0)},o(t){ne(d,t),h=!1},d(t){t&&E(v),d&&d.d(t)}}}const j="http://localhost:8000/api/live-trading",fe="ws://localhost:8000/ws";function pe(r,v,f){let w,D;x(r,oe,e=>f(1,D=e));let{$$slots:A={},$$scope:s}=v,n,L=!1,M;ee(async()=>{await p(),$(),M=setInterval(async()=>{await T()},2e3),await T()}),te(()=>{n&&n.close(),M&&clearInterval(M)});async function p(){try{const a=await(await fetch(`${j}/configs`)).json();le.set(a)}catch(e){console.error("Error loading configs:",e)}}async function T(){try{const a=await(await fetch(`${j}/status`)).json();if(re.set(a),a.config_id){const W=await(await fetch(`${j}/positions?config_id=${a.config_id}`)).json();ce.set(W);const g=await(await fetch(`${j}/statistics?config_id=${a.config_id}`)).json();ve.set(g);const I=await(await fetch(`${j}/indicators`)).json();J.set(I);const q=await(await fetch(`${j}/notifications?config_id=${a.config_id}&limit=100`)).json();z.set(q)}}catch(e){console.error("Error refreshing data:",e)}}function $(){n=new WebSocket(fe),n.onopen=()=>{console.log("WebSocket connected"),L=!0},n.onmessage=e=>{try{const a=JSON.parse(e.data);u(a)}catch(a){console.error("Error parsing WebSocket message:",a)}},n.onerror=e=>{console.error("WebSocket error:",e),L=!1},n.onclose=()=>{console.log("WebSocket disconnected"),L=!1,setTimeout(()=>{L||$()},3e3)}}function u(e){switch(e.type){case"notification":z.update(l=>[e.data,...l]);break;case"position_update":T();break;case"market_data":const a=e.data;a&&a.instrument_token==="256265"&&J.update(l=>({...l,nifty_ltp:a.last_price||l.nifty_ltp}));break;case"tick":T();break}}return r.$$set=e=>{"$$scope"in e&&f(2,s=e.$$scope)},r.$$.update=()=>{r.$$.dirty&2&&f(0,w=D.url.pathname)},[w,D,s,A]}class ye extends se{constructor(v){super(),ae(this,v,pe,de,B,{})}}export{ye as component};
